<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aurélien Sallin">
<meta name="dcterms.date" content="2025-10-20">

<title>Guidelines vs.&nbsp;Financial Incentives Against Low-Value Care: Which Policy Tool Actually Changes Physician Behavior? – Aurélien Sallin</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/intersection-observer-polyfill-1.0.0/intersection-observer.js"></script>
<script src="../../site_libs/quarto-contrib/scrollama-3.2.0/scrollama.min.js"></script>
<script src="../../site_libs/quarto-contrib/closeread-0.1.0/closeread.js"></script>
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta cr-debug-mode="false">
<meta cr-remove-header-space="false">


<link rel="stylesheet" href="../../_extensions/qmd-lab/closeread/closeread.css">
<link rel="stylesheet" href="style_quarto.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Aurélien Sallin, PhD</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">News &amp; Activities</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../file/path/to/myCV.pdf" target="_blank"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ASallin" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <h1 class="title">Guidelines vs.&nbsp;Financial Incentives Against Low-Value Care: Which Policy Tool Actually Changes Physician Behavior?</h1>
            <p class="subtitle lead">Lessons from Switzerland’s Vitamin D case</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-page">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aurélien Sallin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 20, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">
      <!-- user-provided yaml closeread style options -->
      <style>
        :root {
          --cr-narrative-background-color-overlay: rgb(0,43,54,0.75);
--cr-section-background-color: #F5F5F5;
--cr-narrative-background-color-sidebar: #F5F5F5;
--cr-narrative-text-color-sidebar: #333333;
--cr-narrative-text-color-overlay: #e2e2e2;
--cr-narrative-overlay-max-width: 700px;
--cr-narrative-font-size: 1.4rem;
        }
      </style>
    





<hr>
<div class="banner">
<p><img src="img/Vitamin-D.jpg" class="banner-image img-fluid"></p>
</div>
<p><strong>Our Research Question:</strong> How can healthcare systems effectively reduce low-value care that wastes millions in resources?</p>
<p><strong>Our Natural Experiment:</strong> Switzerland tried two different approaches in the case of prescription of Vitamin D tests: clinical guidelines vs.&nbsp;financial restrictions. We tracked what actually happened to the number of prescriptions.</p>
<p><strong>The Results?</strong> 👇 <em>Scroll to see the story unfold…</em></p>
<p>📖 <strong>Full Study:</strong> <a href="https://bmchealthservres.biomedcentral.com/articles/10.1186/s12913-025-13524-9">The impact of Choosing WiselyTM recommendations and insurance coverage restrictions on the provision of low-value care: an interrupted time series analysis of vitamin D tests</a> <span class="citation" data-cites="sallin2025impact">(<a href="#ref-sallin2025impact" role="doc-biblioref">Sallin et al. 2025</a>)</span></p>
<p><br>
</p>
<section id="vitamin-d-and-low-value-care" class="level1">
<h1>Vitamin D and Low-Value Care</h1>
<p>Health systems continue to face the problem of <strong>low-value care</strong>, i.e.&nbsp;services that bring limited benefit to patients while adding costs and administrative effort. Vitamin D testing has become a prominent example.</p>
<p>Although clinical guidelines consistently advise against routine testing for low-risk individuals, the use of these tests has continued to rise in many countries. In Switzerland, testing rates almost doubled between 2013 and 2020, from 96 to 199 tests per 1000 inhabitants.</p>
<section id="a-policy-response" class="level2">
<h2 class="anchored" data-anchor-id="a-policy-response">A Policy Response</h2>
<p>This increase led to several policy measures. In April 2021, the <strong>Smarter Medicine initiative</strong>, which is the Swiss equivalent of Choosing Wisely™, included vitamin D testing in its list of procedures to avoid. The recommendation was simple: no routine measurement of 25(OH)-Vitamin D in patients without risk factors. Physicians were informed of these measures.</p>
<p>A year later, the Federal Office of Public Health introduced a <strong>coverage restriction</strong> (<em>limitatio</em>), limiting reimbursement for such tests. Together, these steps offered a natural experiment to observe how clinical recommendations and financial incentives influence medical practice.</p>
</section>
<section id="using-real-world-data-to-evaluate-the-effect" class="level2">
<h2 class="anchored" data-anchor-id="using-real-world-data-to-evaluate-the-effect">Using Real-World Data to Evaluate the Effect</h2>
<p>To examine these changes, we analyzed <strong>mandatory health insurance claims data</strong> from SWICA, covering about 10% of the Swiss population. The data include more than 3’600 general practitioners and group practices, with adult patients who had at least one consultation between 2018 and 2023.</p>
<p>We applied <strong>interrupted time-series analysis</strong> to estimate how testing volumes evolved around the two interventions. The method compares observed data with a counterfactual trend, which shows what we would expect if the interventions had not taken place.</p>
<p>The models account for patient characteristics, clinical indications for testing based on Swiss guidelines, and physician-specific prescribing behavior. This allows us to isolate the effect of the policy interventions from broader temporal or compositional changes.</p>
</section>
<section id="a-multi-disciplinary-collaboration" class="level2">
<h2 class="anchored" data-anchor-id="a-multi-disciplinary-collaboration">A Multi-Disciplinary Collaboration</h2>
<p>This study is the result of a productive collaboration between the <strong>health services research team at SWICA</strong>, physicians at the <strong>Institute of Primary Care of the University of Zürich</strong>, and health economists at the <strong>Institute of Health Economics and Health Policy of the Bern University of Applied Sciences</strong>.</p>
<p>This collaboration demonstrates how insights from claims data can advance our understanding of the healthcare system and inform policy decisions aimed at reducing costs for the Swiss population.</p>
<p><br>
<br>
</p>
</section>
<section id="the-results-in-one-scroll" class="level2">
<h2 class="anchored" data-anchor-id="the-results-in-one-scroll">The results in one scroll</h2>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-I">
<section id="reading-the-chart-what-are-we-looking-at" class="level3 narrative">
<h3 class="anchored" data-anchor-id="reading-the-chart-what-are-we-looking-at">Reading the Chart: What Are We Looking At?</h3>
<p><span style="color: grey; font-weight: bold; font-size: 1.2em;">●●●</span> <strong>Grey line</strong> = Actual vitamin D tests prescribed each month (real SWICA data)<br>
<span style="color: #E22920; font-weight: bold; font-size: 1.2em;">●●●</span> <strong>Red line</strong> = What our statistical model predicts should happen<br>
<span style="color: #00857C; font-weight: bold; font-size: 1.2em;">▬▬▬</span> <strong>Green box</strong> = COVID-19 lockdown period (March-April 2020)<br>
<strong>Why this matters:</strong> The red and grey lines track closely together, showing our model accurately captures normal prescribing patterns. This means we can detect when policies actually change physician behavior.</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-I">
<section id="vitamin-d-test-prescriptions-rose-despite-low-value-status" class="level3 narrative">
<h3 class="anchored" data-anchor-id="vitamin-d-test-prescriptions-rose-despite-low-value-status">Vitamin D Test Prescriptions Rose Despite Low-Value Status</h3>
<p>Despite clear evidence of low clinical value, vitamin D test prescriptions rose by <strong>20%</strong> between 2018 and 2021.</p>
<p>A textbook example of low-value care in the healthcare system (see also <a href="https://www.versorgungsatlas.ch/indicator/_089">Obsan 2023</a>).</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-II">
<section id="april-2021-smarter-medicine-takes-action" class="level3 narrative">
<h3 class="anchored" data-anchor-id="april-2021-smarter-medicine-takes-action">April 2021: Smarter Medicine Takes Action</h3>
<p>Switzerland’s Choosing Wisely™ campaign places vitamin D testing on their <strong>“Top 5”</strong> list of unnecessary procedures.</p>
<p><br>
</p>
<p><a href="https://www.smartermedicine.ch/de/home"><img src="img/smartermedicine.png" class="img-fluid" width="200"></a></p>
<p><br>
</p>
<p><strong>Clear message</strong>: “No routine testing for patients without risk factors.”</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-3">
<section id="clinical-recommendations-modest-impact" class="level3 narrative">
<h3 class="anchored" data-anchor-id="clinical-recommendations-modest-impact">Clinical Recommendations: Modest Impact</h3>
<p>The Smarter Medicine recommendation shows a <strong>slight downward trend</strong>.</p>
<p>But is this enough? Let’s compare with what would have happened without intervention…</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-4">
<section id="revealing-the-counterfactual" class="level3 narrative">
<h3 class="anchored" data-anchor-id="revealing-the-counterfactual">Revealing the Counterfactual</h3>
<p>The <strong>teal dashed line</strong> shows what would have happened without the recommendation.</p>
<p>Testing rates would have continued climbing upward.</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-4.1">
<section id="the-numbers-clinical-recommendations-work-but-modestly" class="level3 narrative">
<h3 class="anchored" data-anchor-id="the-numbers-clinical-recommendations-work-but-modestly">The Numbers: Clinical Recommendations Work, But Modestly</h3>
<p>We conduct statistical tests to see whether the recommendation led to a recognizable pattern. <strong>The number of tests per consultation falls by 5.98% in the 12 months following the recommendation.</strong></p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-5">
<section id="july-2022-strong-regulatory-measure" class="level3 narrative">
<h3 class="anchored" data-anchor-id="july-2022-strong-regulatory-measure">July 2022: Strong Regulatory Measure</h3>
<p><br>
<a href="https://www.smartermedicine.ch/de/home"><img src="img/bag.png" class="img-fluid"></a><br>
The Federal Office of Public Health restricts coverage. Patients now pay <strong>out-of-pocket</strong> for routine tests.</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-6">
<section id="financial-incentives-the-game-changer" class="level3 narrative">
<h3 class="anchored" data-anchor-id="financial-incentives-the-game-changer">Financial Incentives: The Game Changer</h3>
<p>The number of tests per consultation drops by <strong>57.82%</strong> in the 6 months following the coverage restriction. This is a dramatic drop compared to clinical recommendations alone.</p>
</section>
</div>
<div class="trigger new-trigger" data-focus-on="cr-plot-layout-6.1">
<section id="the-bottom-line-15.65-million-chf-saved" class="level3 narrative">
<h3 class="anchored" data-anchor-id="the-bottom-line-15.65-million-chf-saved">The Bottom Line: 15.65 Million CHF Saved</h3>
<p>Healthcare system savings of <strong>15.65 million CHF</strong> in 2022 alone.</p>
<p>That’s <strong>1.8 CHF per Swiss resident</strong>.</p>
</section>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-plot-layout-I" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-I" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-II" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-3" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-4" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-4.1" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-5" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-6" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-plot-layout-6.1" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scroll_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="key-findings-and-policy-implications" class="level2">
<h2 class="anchored" data-anchor-id="key-findings-and-policy-implications">Key Findings and Policy Implications</h2>
<p>Clinical recommendations alone proved less effective than government regulation in reducing low-value care in Switzerland. However, our analysis revealed important nuances.</p>
<p>We found <strong>no unintended consequences</strong> from the coverage limitation: vitamin D supplementation rates remained unaffected, suggesting the policy successfully targeted testing without compromising appropriate treatment.</p>
<p>However, from a health policy perspective, simply removing procedures from basic insurance coverage cannot be the default solution for addressing unnecessary treatments. This regulatory approach creates high administrative burden for physicians.</p>
<p><strong>A more sustainable solution</strong> lies in strengthening financial incentives that align provider and payer interests. In Switzerland, this can be achieved through <strong>managed care contracts</strong> between physician networks and health insurers within alternative insurance models. These contracts establish quality standards while creating shared financial responsibility among physicians—encouraging appropriate care delivery without heavy-handed regulation.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-sallin2025impact" class="csl-entry" role="listitem">
Sallin, Aurélien, Daniel Ammann, Caroline Bähler, Tobias Müller, Stefan Neuner-Jehle, Oliver Senn, and Eva Blozik. 2025. <span>“The Impact of Choosing WiselyTM Recommendations and Insurance Coverage Restrictions on the Provision of Low-Value Care: An Interrupted Time Series Analysis of Vitamin d Tests.”</span> <em>BMC Health Services Research</em> 25 (1): 1359.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Aurélien Sallin</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with <i class="fa-solid fa-heart" title="a heart" aria-label="heart"></i>, <a href="https://www.r-project.org/about.html" target="_blank"><i class="fa-brands fa-r-project" title="R Project" aria-label="r-project"></i></a> and <a href="https://quarto.org/" target="_blank">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>